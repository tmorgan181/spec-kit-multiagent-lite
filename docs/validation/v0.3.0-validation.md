================================
v0.3.0 Validation Script
================================

üß™ Manual Test Suite for lite-kits v0.3.0
**Focus**: Polish features, error messages, command quality, constants refactor

## Setup: Create Test Environment

```powershell
# Navigate to example project (or create a new test directory)
cd C:\Users\tmorg\Projects\lite-kits\examples\minimal-todo-app

# Start fresh - remove any existing spec-kit structure
Remove-Item -Recurse -Force .specify, .claude, .github -ErrorAction SilentlyContinue

# Create spec-kit structure (AFTER TEST 1)
New-Item -ItemType Directory -Path ".specify", ".claude", ".github\prompts" -Force

# Verify structure
Get-ChildItem -Directory
```

**Expected**: Three directories: `.specify`, `.claude`, `.github`

---

## Test 1: Error Message Quality (NEW in v0.3)

```powershell
# Test without spec-kit structure
cd C:\Users\tmorg\Projects\lite-kits
lite-kits status
```

**Expected**:
- ‚ùå Error message clearly states "not a spec-kit project"
- ‚úÖ Includes installation instructions for Node.js and spec-kit
- ‚úÖ Provides links to resources
- ‚úÖ Explains that lite-kits enhances spec-kit

**What to check**:
- Error mentions Node.js requirement
- Links to spec-kit GitHub repo
- Clear explanation of dependency chain

---

## Test 2: Status (Before Install)

```powershell
cd C:\Users\tmorg\Projects\lite-kits\examples\minimal-todo-app
lite-kits status
```

**Expected**:
- ‚úÖ Shows spec-kit project detected
- ‚úÖ Shows "No kits installed"

---

## Test 2a: Agent Detection with Partial Directory (BUG FIX in v0.3)

```powershell
# Let's test with only .github/ (no .github/prompts/ yet)
Remove-Item -Recurse -Force .github\prompts -ErrorAction SilentlyContinue

# Verify we only have .github/ parent
Test-Path .github         # Should be True
Test-Path .github\prompts # Should be False

# Now test agent detection
lite-kits add --kit dev
```

**Expected** (THIS IS THE BUG FIX):
- ‚úÖ Should detect **both claude AND copilot** agents
- ‚úÖ Preview shows files for `.claude/` AND `.github/prompts/`
- ‚úÖ **NO warning** about "No AI agents detected"

**What we're testing**:
- **Bug fix**: Agent detection now works with parent directory only (`.github/`)
- No longer requires full path (`.github/prompts/`) to exist upfront
- Subdirectory will be created during installation

**Type 'n' to cancel for now**

---

## Test 3: Info Command - Kit Descriptions

```powershell
lite-kits info
```

**Expected**:
- ‚úÖ Shows version 0.3.0
- ‚úÖ Shows "dev" kit (NOT "dev-kit")
- ‚úÖ Shows "multiagent" kit
- ‚úÖ Clear descriptions for each kit
- ‚úÖ Package management instructions

**What to check**:
- Kit names use constants (from __init__.py refactor)
- Descriptions are accurate and helpful

---

## Test 4: Preview with Kit Headers (NEW in v0.3)

```powershell
# Don't confirm yet, just check preview
lite-kits add --recommended
```

**Expected**:
- ‚úÖ **Kit name headers** appear in preview (e.g., "Dev Kit:", "Files:")
- ‚úÖ Shows 14 files to create (7 commands √ó 2 agents)
- ‚úÖ Groups files logically
- ‚úÖ File count summary: "Total files to install: 14"

**What to check**:
- NEW: Kit names as section headers (polish feature from v0.3)
- Clean, organized preview format
- Easy to understand what's being installed

**Type 'n' to cancel**

---

## Test 5: Add with Preview (Confirm)

```powershell
# Type 'y' when prompted
lite-kits add --recommended
```

**Expected**:
- ‚úÖ Shows preview with kit headers
- ‚úÖ Asks for confirmation
- ‚úÖ Installs 14 files (7 commands √ó 2 agents)
- ‚úÖ Success message mentions GitHub Copilot first, then Claude Code
- ‚úÖ Next steps suggest /orient command

**What to check**:
- GitHub Copilot mentioned before Claude Code (v0.3 update)
- All 14 files installed successfully

---

## Test 6: Status (After Install)

```powershell
lite-kits status
```

**Expected**:
- ‚úÖ Shows dev-kit installed (using constant: KIT_DEV = "dev")
- ‚úÖ No errors

---

## Test 7: Validate Installed Files

```powershell
lite-kits validate
```

**Expected**:
- ‚úÖ Validates successfully
- ‚úÖ Shows kit names correctly

---

## Test 8: Verify Command Quality (NEW in v0.3)

```powershell
# Check a few key command files for quality
Get-Content .claude\commands\orient.md | Select-String "dev" -Context 1
Get-Content .claude\commands\commit.md | Select-String "dev-kit" -Context 1
Get-Content .github\prompts\sync.prompt.md | Select-String "powershell" -Context 1
```

**Expected**:
- ‚úÖ orient.md references "dev" kit (not "project" or "git")
- ‚úÖ commit.md references "dev-kit" correctly
- ‚úÖ sync.prompt.md uses PowerShell syntax (NOT bash!) - **FIX from v0.3**

**What to check**:
- No outdated kit references (project-kit/git-kit ‚Üí dev-kit)
- sync.prompt.md fixed to use PowerShell (was bash in earlier builds)
- Cross-command references are accurate

---

## Test 9: Remove All with Empty Directory Cleanup (NEW in v0.3)

```powershell
lite-kits remove --all
# Type 'y' to confirm
```

**Expected**:
- ‚úÖ Shows preview of files to remove
- ‚úÖ Asks for confirmation
- ‚úÖ Removes all kit files
- ‚úÖ **NEW**: Deletes empty directories (.claude/commands/, .github/prompts/)

**What to check**:
- Empty directories are cleaned up (v0.3 feature)
- Check if `.claude/commands/` still exists (should be GONE if empty)

```powershell
# Verify empty directories were removed
Test-Path .claude\commands
Test-Path .github\prompts
```

**Expected**: Both should return `False` (directories deleted)

---

## Test 10: Agent-Specific Install

```powershell
# Install only for Claude
lite-kits add --agent claude
# Type 'y' to confirm
```

**Expected**:
- ‚úÖ Preview shows only .claude/commands/ files (7 files)
- ‚úÖ No .github/prompts/ files
- ‚úÖ Installation succeeds

```powershell
# Check directory structure
Get-ChildItem .claude\commands
Get-ChildItem .github\prompts -ErrorAction SilentlyContinue
```

**Expected**:
- `.claude/commands/` has 7 files
- `.github/prompts/` does NOT exist

---

## Test 11: Reinstall Detection

```powershell
# Try to install again
lite-kits add --agent claude
```

**Expected**:
- ‚ö†Ô∏è Warning: "Enhancement kits appear to be already installed"
- ‚ùì Asks: "Reinstall anyway? [y/N]"

**Type 'n' to cancel**

---

## Test 12: Force Reinstall

```powershell
lite-kits add --force --agent claude
```

**Expected**:
- ‚úÖ No preview shown (--force skips)
- ‚úÖ Reinstalls without prompting
- ‚úÖ Success message

---

## Test 13: Remove with Empty Directory Check

```powershell
lite-kits remove --all
# Type 'y' to confirm

# Immediately check if empty directories removed
Test-Path .claude\commands
```

**Expected**:
- ‚úÖ Removal succeeds
- ‚úÖ `.claude/commands/` directory deleted (empty after removal)
- **NEW**: Empty directory cleanup working

---

## Test 14: Status (After Complete Removal)

```powershell
lite-kits status
```

**Expected**:
- ‚úÖ Shows spec-kit project detected
- ‚úÖ Shows "No kits installed"
- ‚úÖ No leftover directories

---

## Test 15: Multiagent Kit (Optional)

```powershell
# Install with multiagent
lite-kits add --kit multiagent
# Type 'y' to confirm
```

**Expected**:
- ‚úÖ Shows dev-kit + multiagent-kit in preview (auto-dependency)
- ‚úÖ Installs both kits
- ‚úÖ /sync command available for both agents

```powershell
# Verify sync.prompt.md uses PowerShell
Get-Content .github\prompts\sync.prompt.md | Select-String '$CurrentBranch'
```

**Expected**: Should find PowerShell variables like `$CurrentBranch` (NOT bash `CURRENT_BRANCH=$(...)`)

---

## Cleanup

```powershell
# Remove all kits
lite-kits remove --all
# Type 'y' to confirm

# Remove spec-kit structure
Remove-Item -Recurse -Force .specify, .claude, .github -ErrorAction SilentlyContinue

# Verify clean
Get-ChildItem -Directory
```

**Expected**: Back to original state (only README.md or empty)

---

## üéØ v0.3.0 Specific Checks

### NEW Features to Validate:

1. **‚úÖ Command Audit Results**
   - No outdated kit references (project-kit/git-kit)
   - sync.prompt.md uses PowerShell (not bash)
   - All cross-command references accurate

2. **‚úÖ Better Error Messages**
   - Error for "not spec-kit" mentions Node.js
   - Links to spec-kit repo
   - Clear installation guidance

3. **‚úÖ README Prerequisites**
   - Node.js mentioned as requirement
   - spec-kit marked as REQUIRED
   - AI assistant compatibility explained

4. **‚úÖ Preview Kit Headers**
   - Kit names appear as headers in preview
   - Clearer visual organization

5. **‚úÖ Delete Empty Folders**
   - `.claude/commands/` removed after uninstall
   - `.github/prompts/` removed after uninstall
   - Clean removal experience

6. **‚úÖ Constitution Template**
   - `.specify/memory/constitution.md` has real lite-kits principles
   - Not a generic template

7. **‚úÖ Constants Refactor**
   - Kit names consistent (KIT_DEV = "dev")
   - Version consistent across files (0.3.0)
   - Error messages use constants

8. **‚úÖ Agent Detection Bug Fix** (NEW)
   - Detects agents when only parent directory exists
   - `.github/` detection works without `.github/prompts/`
   - More flexible directory structure handling

---

## ‚úÖ Success Criteria

All tests should pass with:

- ‚úÖ No errors or crashes
- ‚úÖ Preview always shows before operations (unless --force)
- ‚úÖ Confirmations work correctly
- ‚úÖ Files installed in correct locations
- ‚úÖ Agent detection works (installs for both Claude + Copilot)
- ‚úÖ --agent flag filters correctly
- ‚úÖ Clean, readable output
- ‚úÖ **NEW**: Kit headers in preview
- ‚úÖ **NEW**: Empty directories deleted on removal
- ‚úÖ **NEW**: Error messages include installation guidance
- ‚úÖ **NEW**: sync.prompt.md uses PowerShell (not bash)
- ‚úÖ **NEW**: All kit references updated (dev instead of project/git)

---

## üìù Notes Section (Fill in during testing)

**Tester**: _______________
**Date**: _______________
**Version**: 0.3.0

### Issues Found:

1.

### Observations:

1.

### Overall Assessment:

- [ ] Ready to ship
- [ ] Needs fixes

---

## üéØ What We're Validating

**v0.3.0 is a polish release**. We're specifically checking:

1. **User experience**: Error messages, preview formatting, next steps
2. **Code quality**: Constants refactor, command audit fixes
3. **Documentation**: README accuracy, constitution content
4. **Cleanup**: Empty directory removal working correctly
5. **Command quality**: All 16 files audited and fixed

If all tests pass, we're **ready for PyPI**! üöÄ
